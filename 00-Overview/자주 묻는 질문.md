# â“ ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ (FAQ)

> ì˜¨í”„ë ˜ Kubernetes ìš´ì˜ ì¤‘ ìì£¼ ë°œìƒí•˜ëŠ” ì§ˆë¬¸ê³¼ í•´ê²°ì±…

## ğŸ—ï¸ ì„¤ì¹˜ì™€ ì´ˆê¸° ì„¤ì •

### Q1. kubeadm init ì‹¤í–‰ ì‹œ "connection refused" ì˜¤ë¥˜ê°€ ë°œìƒí•©ë‹ˆë‹¤

**A1.** ë‹¤ìŒ ì‚¬í•­ë“¤ì„ í™•ì¸í•˜ì„¸ìš”:

```bash
# 1. containerd ìƒíƒœ í™•ì¸
sudo systemctl status containerd

# 2. kubelet ìƒíƒœ í™•ì¸
sudo systemctl status kubelet

# 3. ë°©í™”ë²½ ì„¤ì • í™•ì¸
sudo ufw status
# ë˜ëŠ” í•„ìš”í•œ í¬íŠ¸ ì˜¤í”ˆ:
sudo ufw allow 6443/tcp
sudo ufw allow 2379:2380/tcp
sudo ufw allow 10250:10252/tcp

# 4. swap ë¹„í™œì„±í™” í™•ì¸
free -h
sudo swapoff -a

# 5. ë„¤íŠ¸ì›Œí¬ ì„¤ì • í™•ì¸
ip route show
```

### Q2. CNI í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜ í›„ì—ë„ ë…¸ë“œê°€ NotReady ìƒíƒœì…ë‹ˆë‹¤

**A2.** CNI ì„¤ì •ì„ í™•ì¸í•˜ê³  ì¬ì„¤ì¹˜í•˜ì„¸ìš”:

```bash
# 1. CNI Pod ìƒíƒœ í™•ì¸
kubectl get pods -n kube-system | grep -E "calico|flannel|weave"

# 2. CNI Pod ë¡œê·¸ í™•ì¸
kubectl logs -n kube-system <cni-pod-name>

# 3. ë„¤íŠ¸ì›Œí¬ ì„¤ì • í™•ì¸
cat /etc/cni/net.d/*

# 4. CNI ì¬ì„¤ì¹˜ (Calico ì˜ˆì‹œ)
kubectl delete -f https://raw.githubusercontent.com/projectcalico/calico/v3.26.0/manifests/tigera-operator.yaml
kubectl apply -f https://raw.githubusercontent.com/projectcalico/calico/v3.26.0/manifests/tigera-operator.yaml
```

### Q3. ì›Œì»¤ ë…¸ë“œ ì¡°ì¸ì´ ì‹¤íŒ¨í•©ë‹ˆë‹¤

**A3.** í† í°ê³¼ ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ í™•ì¸í•˜ì„¸ìš”:

```bash
# 1. í† í° ìœ íš¨ì„± í™•ì¸ (ë§ˆìŠ¤í„° ë…¸ë“œì—ì„œ)
kubeadm token list

# 2. ìƒˆ í† í° ìƒì„± (í•„ìš”ì‹œ)
kubeadm token create --print-join-command

# 3. ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸ (ì›Œì»¤ ë…¸ë“œì—ì„œ)
telnet <MASTER_IP> 6443

# 4. ì¸ì¦ì„œ í•´ì‹œ ì¬í™•ì¸
openssl x509 -pubkey -in /etc/kubernetes/pki/ca.crt | openssl rsa -pubin -outform der 2>/dev/null | openssl dgst -sha256 -hex | sed 's/^.* //'
```

## ğŸ”§ í´ëŸ¬ìŠ¤í„° ê´€ë¦¬

### Q4. etcd ë°±ì—…ì€ ì–´ë–»ê²Œ ìë™í™”í•˜ë‚˜ìš”?

**A4.** cronì„ ì‚¬ìš©í•œ ìë™ ë°±ì—… ìŠ¤í¬ë¦½íŠ¸:

```bash
#!/bin/bash
# /usr/local/bin/etcd-backup.sh

BACKUP_DIR="/var/backups/etcd"
DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_FILE="$BACKUP_DIR/etcd-snapshot-$DATE.db"

mkdir -p "$BACKUP_DIR"

ETCDCTL_API=3 etcdctl snapshot save "$BACKUP_FILE" \
    --endpoints=https://127.0.0.1:2379 \
    --cacert=/etc/kubernetes/pki/etcd/ca.crt \
    --cert=/etc/kubernetes/pki/etcd/server.crt \
    --key=/etc/kubernetes/pki/etcd/server.key

# ê²€ì¦ ë° ì••ì¶•
ETCDCTL_API=3 etcdctl snapshot status "$BACKUP_FILE"
gzip "$BACKUP_FILE"

# 30ì¼ ì´ìƒëœ ë°±ì—… ì‚­ì œ
find "$BACKUP_DIR" -name "etcd-snapshot-*.db.gz" -mtime +30 -delete

# crontab ì„¤ì •: ë§¤ì¼ ìƒˆë²½ 2ì‹œ
# 0 2 * * * /usr/local/bin/etcd-backup.sh >> /var/log/etcd-backup.log 2>&1
```

### Q5. í´ëŸ¬ìŠ¤í„° ì—…ê·¸ë ˆì´ë“œëŠ” ì–´ë–»ê²Œ í•˜ë‚˜ìš”?

**A5.** ë‹¨ê³„ë³„ ì—…ê·¸ë ˆì´ë“œ ì ˆì°¨:

```bash
# 1. í˜„ì¬ ë²„ì „ í™•ì¸
kubectl version --short

# 2. ì‚¬ìš© ê°€ëŠ¥í•œ ë²„ì „ í™•ì¸
apt update
apt-cache madison kubeadm

# 3. kubeadm ë¨¼ì € ì—…ê·¸ë ˆì´ë“œ (ë§ˆìŠ¤í„° ë…¸ë“œ)
apt-mark unhold kubeadm
apt-get update && apt-get install -y kubeadm=1.28.1-00
apt-mark hold kubeadm

# 4. ì—…ê·¸ë ˆì´ë“œ ê³„íš í™•ì¸
kubeadm upgrade plan

# 5. ë§ˆìŠ¤í„° ë…¸ë“œ ì—…ê·¸ë ˆì´ë“œ
kubeadm upgrade apply v1.28.1

# 6. kubeletê³¼ kubectl ì—…ê·¸ë ˆì´ë“œ
apt-mark unhold kubelet kubectl
apt-get update && apt-get install -y kubelet=1.28.1-00 kubectl=1.28.1-00
apt-mark hold kubelet kubectl
sudo systemctl restart kubelet

# 7. ì›Œì»¤ ë…¸ë“œë“¤ ìˆœì°¨ì ìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œ
# (ê° ì›Œì»¤ ë…¸ë“œì—ì„œ)
kubectl drain <worker-node> --ignore-daemonsets
# kubeadmê³¼ kubelet ì—…ê·¸ë ˆì´ë“œ í›„
kubectl uncordon <worker-node>
```

### Q6. ë…¸ë“œê°€ ê°‘ìê¸° NotReady ìƒíƒœê°€ ë˜ì—ˆìŠµë‹ˆë‹¤

**A6.** ë‹¨ê³„ë³„ ì§„ë‹¨ ë° í•´ê²°:

```bash
# 1. ë…¸ë“œ ìƒíƒœ ìƒì„¸ í™•ì¸
kubectl describe node <node-name>

# 2. ë…¸ë“œ SSH ì ‘ì†í•˜ì—¬ í™•ì¸
ssh <node-ip>

# 3. kubelet ìƒíƒœ í™•ì¸
sudo systemctl status kubelet
sudo journalctl -u kubelet -f

# 4. ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ í™•ì¸
sudo systemctl status containerd
sudo crictl ps

# 5. ë””ìŠ¤í¬ ê³µê°„ í™•ì¸
df -h
sudo du -sh /var/lib/kubelet/*

# 6. ë©”ëª¨ë¦¬ í™•ì¸
free -h

# 7. ë³µêµ¬ ì‹œë„
sudo systemctl restart kubelet
sudo systemctl restart containerd
```

## ğŸ“¦ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬

### Q7. Podê°€ ImagePullBackOff ìƒíƒœì…ë‹ˆë‹¤

**A7.** ì´ë¯¸ì§€ ê´€ë ¨ ë¬¸ì œ í•´ê²°:

```bash
# 1. Pod ìƒì„¸ ì •ë³´ í™•ì¸
kubectl describe pod <pod-name>

# 2. ì´ë¯¸ì§€ URL í™•ì¸
kubectl get pod <pod-name> -o jsonpath='{.spec.containers[0].image}'

# 3. ìˆ˜ë™ ì´ë¯¸ì§€ í’€ í…ŒìŠ¤íŠ¸ (í•´ë‹¹ ë…¸ë“œì—ì„œ)
ssh <node-ip>
sudo crictl pull <image-name>

# 4. ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì¸ì¦ ì •ë³´ í™•ì¸
kubectl get secrets | grep docker
kubectl describe secret <registry-secret>

# 5. í”„ë¼ì´ë¹— ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì‹œí¬ë¦¿ ìƒì„±
kubectl create secret docker-registry regcred \
  --docker-server=<registry-url> \
  --docker-username=<username> \
  --docker-password=<password> \
  --docker-email=<email>

# 6. Podì— imagePullSecrets ì¶”ê°€
kubectl patch deployment <deployment-name> -p '{"spec":{"template":{"spec":{"imagePullSecrets":[{"name":"regcred"}]}}}}'
```

### Q8. Podê°€ Pending ìƒíƒœì—ì„œ ë©ˆì¶°ìˆìŠµë‹ˆë‹¤

**A8.** ìŠ¤ì¼€ì¤„ë§ ë¬¸ì œ ì§„ë‹¨:

```bash
# 1. Pod ì´ë²¤íŠ¸ í™•ì¸
kubectl describe pod <pod-name>

# 2. ë…¸ë“œ ë¦¬ì†ŒìŠ¤ í™•ì¸
kubectl describe nodes

# 3. ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ í™•ì¸
kubectl top nodes
kubectl top pods --all-namespaces

# 4. íƒ€ì¸íŠ¸/í†¨ëŸ¬ë ˆì´ì…˜ í™•ì¸
kubectl get nodes -o json | jq '.items[] | {name: .metadata.name, taints: .spec.taints}'

# 5. ë…¸ë“œ ì…€ë ‰í„° í™•ì¸
kubectl get pod <pod-name> -o yaml | grep -A 5 nodeSelector

# 6. PVC ìƒíƒœ í™•ì¸ (ìŠ¤í† ë¦¬ì§€ ë¬¸ì œì¸ ê²½ìš°)
kubectl get pvc
kubectl describe pvc <pvc-name>
```

### Q9. ì„œë¹„ìŠ¤ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì ‘ê·¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤

**A9.** ë„¤íŠ¸ì›Œí‚¹ ë¬¸ì œ í•´ê²°:

```bash
# 1. ì„œë¹„ìŠ¤ì™€ ì—”ë“œí¬ì¸íŠ¸ í™•ì¸
kubectl get svc
kubectl get endpoints <service-name>

# 2. Pod ë¼ë²¨ê³¼ ì„œë¹„ìŠ¤ ì…€ë ‰í„° ë¹„êµ
kubectl get pods --show-labels
kubectl get svc <service-name> -o yaml | grep -A 3 selector

# 3. ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„± í…ŒìŠ¤íŠ¸
kubectl run test-pod --image=busybox --rm -it --restart=Never -- /bin/sh
# Pod ë‚´ì—ì„œ:
# nslookup <service-name>
# wget -qO- <service-name>:<port>

# 4. kube-proxy í™•ì¸
kubectl get pods -n kube-system | grep kube-proxy
kubectl logs -n kube-system <kube-proxy-pod>

# 5. iptables ê·œì¹™ í™•ì¸ (ë…¸ë“œì—ì„œ)
sudo iptables -L -n -t nat | grep <service-name>
```

## ğŸ”’ ë³´ì•ˆê³¼ ê¶Œí•œ

### Q10. RBAC ê¶Œí•œì„ ì–´ë–»ê²Œ ì„¤ì •í•˜ë‚˜ìš”?

**A10.** ë‹¨ê³„ë³„ RBAC ì„¤ì •:

```bash
# 1. ì„œë¹„ìŠ¤ ì–´ì¹´ìš´íŠ¸ ìƒì„±
kubectl create serviceaccount <sa-name>

# 2. Role ìƒì„± (ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìˆ˜ì¤€)
cat <<EOF | kubectl apply -f -
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: default
  name: pod-reader
rules:
- apiGroups: [""]
  resources: ["pods"]
  verbs: ["get", "watch", "list"]
EOF

# 3. RoleBinding ìƒì„±
kubectl create rolebinding <binding-name> \
  --role=pod-reader \
  --serviceaccount=default:<sa-name>

# 4. ê¶Œí•œ í…ŒìŠ¤íŠ¸
kubectl auth can-i list pods --as=system:serviceaccount:default:<sa-name>

# 5. í´ëŸ¬ìŠ¤í„° ìˆ˜ì¤€ ê¶Œí•œ (ClusterRole/ClusterRoleBinding)
kubectl create clusterrole <role-name> --verb=get,list,watch --resource=nodes
kubectl create clusterrolebinding <binding-name> \
  --clusterrole=<role-name> \
  --serviceaccount=default:<sa-name>
```

### Q11. Pod ë³´ì•ˆ ì •ì±…ì„ ì–´ë–»ê²Œ ì ìš©í•˜ë‚˜ìš”?

**A11.** Pod Security Standards ì ìš©:

```bash
# 1. ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ë³´ì•ˆ ì •ì±… ë¼ë²¨ ì¶”ê°€
kubectl label namespace <namespace> pod-security.kubernetes.io/enforce=restricted
kubectl label namespace <namespace> pod-security.kubernetes.io/audit=restricted
kubectl label namespace <namespace> pod-security.kubernetes.io/warn=restricted

# 2. ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸ ì˜ˆì‹œ
cat <<EOF | kubectl apply -f -
apiVersion: apps/v1
kind: Deployment
metadata:
  name: secure-app
spec:
  template:
    spec:
      securityContext:
        runAsNonRoot: true
        runAsUser: 1000
        fsGroup: 2000
      containers:
      - name: app
        image: nginx
        securityContext:
          allowPrivilegeEscalation: false
          readOnlyRootFilesystem: true
          capabilities:
            drop:
            - ALL
        volumeMounts:
        - name: tmp
          mountPath: /tmp
        - name: var-cache
          mountPath: /var/cache/nginx
      volumes:
      - name: tmp
        emptyDir: {}
      - name: var-cache
        emptyDir: {}
EOF
```

## ğŸ” ëª¨ë‹ˆí„°ë§ê³¼ ë¡œê¹…

### Q12. Prometheusê°€ ë©”íŠ¸ë¦­ì„ ìˆ˜ì§‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤

**A12.** Prometheus ì„¤ì • í™•ì¸:

```bash
# 1. Prometheus Pod ìƒíƒœ í™•ì¸
kubectl get pods -n monitoring | grep prometheus

# 2. Prometheus ì„¤ì • í™•ì¸
kubectl get prometheus -n monitoring
kubectl describe prometheus <prometheus-name> -n monitoring

# 3. ServiceMonitor í™•ì¸
kubectl get servicemonitor -n monitoring
kubectl describe servicemonitor <sm-name> -n monitoring

# 4. ì„œë¹„ìŠ¤ ë¼ë²¨ í™•ì¸
kubectl get svc --show-labels | grep <service-name>

# 5. Prometheus íƒ€ê²Ÿ í™•ì¸ (í¬íŠ¸ í¬ì›Œë”© í›„)
kubectl port-forward -n monitoring svc/prometheus-operated 9090:9090
# ë¸Œë¼ìš°ì €ì—ì„œ http://localhost:9090/targets í™•ì¸

# 6. ì• í”Œë¦¬ì¼€ì´ì…˜ ë©”íŠ¸ë¦­ ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸
kubectl exec -it <pod-name> -- curl localhost:<metrics-port>/metrics
```

### Q13. ë¡œê·¸ë¥¼ ì¤‘ì•™ì—ì„œ ìˆ˜ì§‘í•˜ë ¤ë©´ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?

**A13.** EFK ìŠ¤íƒ êµ¬ì„±:

```bash
# 1. Elasticsearch ì„¤ì¹˜
helm repo add elastic https://helm.elastic.co
helm install elasticsearch elastic/elasticsearch -n logging --create-namespace

# 2. Fluentd DaemonSet ë°°í¬
kubectl apply -f https://raw.githubusercontent.com/fluent/fluentd-kubernetes-daemonset/master/fluentd-daemonset-elasticsearch-rbac.yaml

# 3. Kibana ì„¤ì¹˜
helm install kibana elastic/kibana -n logging

# 4. ë¡œê·¸ í™•ì¸
kubectl logs -n logging <fluentd-pod>

# 5. Kibana ì ‘ì†
kubectl port-forward -n logging svc/kibana-kibana 5601:5601
```

## ğŸ’¾ ìŠ¤í† ë¦¬ì§€

### Q14. PVCê°€ Pending ìƒíƒœì…ë‹ˆë‹¤

**A14.** ìŠ¤í† ë¦¬ì§€ ë¬¸ì œ í•´ê²°:

```bash
# 1. StorageClass í™•ì¸
kubectl get storageclass
kubectl describe storageclass <sc-name>

# 2. PVC ìƒì„¸ ì •ë³´
kubectl describe pvc <pvc-name>

# 3. ê¸°ë³¸ StorageClass ì„¤ì •
kubectl patch storageclass <sc-name> -p '{"metadata": {"annotations":{"storageclass.kubernetes.io/is-default-class":"true"}}}'

# 4. ìˆ˜ë™ PV ìƒì„± (ì •ì  í”„ë¡œë¹„ì €ë‹)
cat <<EOF | kubectl apply -f -
apiVersion: v1
kind: PersistentVolume
metadata:
  name: manual-pv
spec:
  capacity:
    storage: 10Gi
  accessModes:
    - ReadWriteOnce
  persistentVolumeReclaimPolicy: Retain
  hostPath:
    path: /tmp/data
EOF
```

### Q15. ì»¨í…Œì´ë„ˆì—ì„œ ìŠ¤í† ë¦¬ì§€ì— ì“¸ ìˆ˜ ì—†ìŠµë‹ˆë‹¤

**A15.** ê¶Œí•œ ë¬¸ì œ í•´ê²°:

```bash
# 1. ë§ˆìš´íŠ¸ í¬ì¸íŠ¸ í™•ì¸
kubectl exec -it <pod-name> -- ls -la /mnt/data

# 2. fsGroup ì„¤ì •
cat <<EOF | kubectl apply -f -
apiVersion: v1
kind: Pod
metadata:
  name: pod-with-storage
spec:
  securityContext:
    fsGroup: 2000
  containers:
  - name: app
    image: busybox
    command: ["sleep", "3600"]
    volumeMounts:
    - name: data
      mountPath: /mnt/data
  volumes:
  - name: data
    persistentVolumeClaim:
      claimName: <pvc-name>
EOF

# 3. initContainerë¡œ ê¶Œí•œ ì„¤ì •
initContainers:
- name: fix-permissions
  image: busybox
  command: ["chown", "-R", "1000:1000", "/mnt/data"]
  volumeMounts:
  - name: data
    mountPath: /mnt/data
```

## ğŸŒ ë„¤íŠ¸ì›Œí‚¹

### Q16. ì™¸ë¶€ì—ì„œ ì„œë¹„ìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤

**A16.** Ingressì™€ LoadBalancer ì„¤ì •:

```bash
# 1. Ingress Controller í™•ì¸
kubectl get pods -n ingress-nginx
kubectl get svc -n ingress-nginx

# 2. MetalLB ì„¤ì • í™•ì¸ (ë² ì–´ë©”íƒˆ í™˜ê²½)
kubectl get pods -n metallb-system
kubectl get ipaddresspool -n metallb-system

# 3. Ingress ë¦¬ì†ŒìŠ¤ í™•ì¸
kubectl get ingress
kubectl describe ingress <ingress-name>

# 4. DNS ì„¤ì • í™•ì¸
nslookup <domain-name>

# 5. ë°©í™”ë²½ ê·œì¹™ í™•ì¸
sudo iptables -L -n | grep <port>
```

### Q17. Pod ê°„ í†µì‹ ì´ ì•ˆ ë©ë‹ˆë‹¤

**A17.** ë„¤íŠ¸ì›Œí¬ ì •ì±… í™•ì¸:

```bash
# 1. ë„¤íŠ¸ì›Œí¬ ì •ì±… í™•ì¸
kubectl get networkpolicy --all-namespaces
kubectl describe networkpolicy <policy-name>

# 2. Pod IP í™•ì¸
kubectl get pods -o wide

# 3. ì—°ê²° í…ŒìŠ¤íŠ¸
kubectl exec -it <pod1> -- ping <pod2-ip>
kubectl exec -it <pod1> -- telnet <pod2-ip> <port>

# 4. CNI ë¡œê·¸ í™•ì¸
kubectl logs -n kube-system <cni-pod>

# 5. ë„¤íŠ¸ì›Œí¬ ì •ì±… ì„ì‹œ ë¹„í™œì„±í™” (í…ŒìŠ¤íŠ¸ìš©)
kubectl delete networkpolicy --all -n <namespace>
```

---

> ğŸ’¡ **ì¶”ê°€ ë„ì›€ë§**:
> - ë¬¸ì œ í•´ê²° ì‹œ í•­ìƒ `kubectl describe`ì™€ `kubectl logs`ë¥¼ ë¨¼ì € í™•ì¸í•˜ì„¸ìš”
> - ì‹œìŠ¤í…œ ì´ë²¤íŠ¸ëŠ” `kubectl get events --sort-by='.lastTimestamp'`ë¡œ í™•ì¸
> - ë³µì¡í•œ ë¬¸ì œëŠ” ë‹¨ê³„ë³„ë¡œ ë‚˜ëˆ„ì–´ ì ‘ê·¼í•˜ì„¸ìš”
> - ì„¤ì • ë³€ê²½ ì „ì—ëŠ” ë°˜ë“œì‹œ ë°±ì—…ì„ ìƒì„±í•˜ì„¸ìš”

**ê´€ë ¨ ë¬¸ì„œ**: [[09-Operations/íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ]] | [[00-Overview/ë¹ ë¥¸ ì°¸ì¡° ê°€ì´ë“œ]] | [[Scripts/í´ëŸ¬ìŠ¤í„° ê´€ë¦¬ ìŠ¤í¬ë¦½íŠ¸]]